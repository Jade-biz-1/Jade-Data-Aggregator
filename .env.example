# Data Aggregator Platform - Environment Variables
# Copy this file to .env and update with your values

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Application
APP_NAME="Data Aggregator Platform"
APP_VERSION=1.0.0
DEBUG=true

# API Configuration
API_HOST=0.0.0.0
API_PORT=8001
API_RELOAD=true  # Set to false in production

# Frontend URL (for CORS)
FRONTEND_URL=http://localhost:3000

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/dataaggregator
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_RECYCLE=3600  # 1 hour in seconds
DATABASE_ECHO=false  # Set to true for SQL query logging

# Database Backup
DATABASE_BACKUP_ENABLED=true
DATABASE_BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
DATABASE_BACKUP_RETENTION_DAYS=30

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Cache and Pub/Sub
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Leave empty if no password
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5

# Cache TTL (in seconds)
CACHE_DEFAULT_TTL=300  # 5 minutes
CACHE_QUERY_TTL=300
CACHE_API_RESPONSE_TTL=300
CACHE_USER_SESSION_TTL=3600  # 1 hour

# =============================================================================
# KAFKA CONFIGURATION
# =============================================================================

# Kafka Event Streaming
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_GROUP_ID=dataaggregator
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_MAX_POLL_RECORDS=500

# Kafka Topics
KAFKA_TOPIC_PIPELINE_EVENTS=pipeline-events
KAFKA_TOPIC_SYSTEM_EVENTS=system-events
KAFKA_TOPIC_AUDIT_LOGS=audit-logs

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password Requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true

# Session Configuration
SESSION_TIMEOUT_MINUTES=30
SESSION_COOKIE_NAME=dataaggregator_session
SESSION_COOKIE_SECURE=false  # Set to true in production with HTTPS
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# CORS Settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================

# SMTP Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Email Settings
EMAIL_FROM_ADDRESS=noreply@dataaggregator.com
EMAIL_FROM_NAME="Data Aggregator Platform"
EMAIL_VERIFICATION_ENABLED=true
EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24

# =============================================================================
# FILE PROCESSING
# =============================================================================

# File Upload
MAX_FILE_SIZE_MB=500
ALLOWED_FILE_TYPES=csv,json,xml,xlsx,xls,parquet,txt,pdf,zip,tar,gz
UPLOAD_CHUNK_SIZE_MB=5
FILE_STORAGE_PATH=/var/dataaggregator/uploads
TEMP_FILE_RETENTION_HOURS=24

# File Processing
FILE_PROCESSING_ENABLED=true
FILE_VALIDATION_ENABLED=true
VIRUS_SCANNING_ENABLED=false  # Set to true if ClamAV is installed
CLAMAV_HOST=localhost
CLAMAV_PORT=3310

# =============================================================================
# MONITORING & LOGGING
# =============================================================================

# Logging Configuration
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text
LOG_FILE_PATH=/var/log/dataaggregator/app.log
LOG_FILE_MAX_SIZE_MB=100
LOG_FILE_BACKUP_COUNT=10
LOG_ROTATION_INTERVAL=midnight  # midnight, W0 (Monday), or interval in seconds

# Correlation ID
CORRELATION_ID_HEADER=X-Correlation-ID
GENERATE_CORRELATION_ID=true

# Structured Logging
ENABLE_STRUCTURED_LOGGING=true
LOG_REQUESTS=true
LOG_RESPONSES=false  # Set to true for debugging
LOG_SQL_QUERIES=false  # Set to true for debugging

# Log Archival
LOG_ARCHIVAL_ENABLED=true
LOG_ARCHIVAL_RETENTION_DAYS=90
LOG_ARCHIVE_COMPRESSION=gzip

# =============================================================================
# PROMETHEUS & METRICS
# =============================================================================

# Metrics Configuration
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Custom Metrics
ENABLE_CUSTOM_METRICS=true
METRICS_COLLECTION_INTERVAL_SECONDS=60

# =============================================================================
# ALERT MANAGEMENT
# =============================================================================

# Alerts
ALERTING_ENABLED=true
ALERT_DEFAULT_COOLDOWN_MINUTES=60
ALERT_NOTIFICATION_TIMEOUT_SECONDS=30

# Notification Channels
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_NOTIFICATIONS_ENABLED=false
SLACK_DEFAULT_CHANNEL=#alerts

WEBHOOK_NOTIFICATIONS_ENABLED=false
WEBHOOK_DEFAULT_URL=https://your-webhook-endpoint.com/alerts

# Email Alerts
EMAIL_ALERTS_ENABLED=true
EMAIL_ALERT_RECIPIENTS=admin@example.com,ops@example.com

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================

# WebSocket Settings
WEBSOCKET_ENABLED=true
WEBSOCKET_PATH=/ws
WEBSOCKET_PING_INTERVAL_SECONDS=30
WEBSOCKET_PING_TIMEOUT_SECONDS=10
WEBSOCKET_MAX_CONNECTIONS=1000

# Real-time Metrics
REALTIME_METRICS_ENABLED=true
METRICS_BROADCAST_INTERVAL_SECONDS=5

# =============================================================================
# PIPELINE EXECUTION
# =============================================================================

# Pipeline Execution
PIPELINE_MAX_CONCURRENT_EXECUTIONS=10
PIPELINE_EXECUTION_TIMEOUT_MINUTES=60
PIPELINE_RETRY_ATTEMPTS=3
PIPELINE_RETRY_DELAY_SECONDS=5

# Celery Task Queue (if using Celery)
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC

# =============================================================================
# CONNECTOR CONFIGURATION
# =============================================================================

# Connector Timeouts
CONNECTOR_CONNECTION_TIMEOUT_SECONDS=30
CONNECTOR_READ_TIMEOUT_SECONDS=60
CONNECTOR_MAX_RETRIES=3

# Database Connectors
DB_CONNECTOR_POOL_SIZE=5
DB_CONNECTOR_MAX_OVERFLOW=10
DB_CONNECTOR_POOL_PRE_PING=true

# API Connectors
API_CONNECTOR_VERIFY_SSL=true
API_CONNECTOR_FOLLOW_REDIRECTS=true
API_CONNECTOR_MAX_REDIRECTS=5

# =============================================================================
# CLOUD STORAGE (Optional)
# =============================================================================

# AWS S3
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=dataaggregator-files
AWS_S3_ENDPOINT_URL=  # Leave empty for AWS, set for MinIO/S3-compatible

# Google Cloud Storage
GCP_PROJECT_ID=your-project-id
GCP_BUCKET_NAME=dataaggregator-files
GCP_CREDENTIALS_PATH=/path/to/credentials.json

# Azure Blob Storage
AZURE_STORAGE_CONNECTION_STRING=your-connection-string
AZURE_CONTAINER_NAME=dataaggregator-files

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Sentry Error Tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0

# DataDog APM
DATADOG_ENABLED=false
DATADOG_API_KEY=
DATADOG_APP_KEY=
DATADOG_SITE=datadoghq.com

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature Toggles
FEATURE_VISUAL_PIPELINE_BUILDER=true
FEATURE_REAL_TIME_DASHBOARD=true
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_FILE_PROCESSING=true
FEATURE_SCHEMA_MAPPING=true
FEATURE_PIPELINE_TEMPLATES=true
FEATURE_VERSION_CONTROL=true
FEATURE_GLOBAL_SEARCH=true

# Experimental Features
EXPERIMENTAL_AI_SUGGESTIONS=false
EXPERIMENTAL_AUTO_HEALING=false
EXPERIMENTAL_MARKETPLACE=false

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development Only (DO NOT USE IN PRODUCTION)
DEV_AUTO_CREATE_ADMIN=false
DEV_ADMIN_EMAIL=admin@example.com
DEV_ADMIN_PASSWORD=admin123
DEV_SEED_DATA=false

# Testing
TESTING=false
TEST_DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/dataaggregator_test

# =============================================================================
# TERRAFORM/INFRASTRUCTURE (for automated deployment)
# =============================================================================

# Infrastructure
TF_VAR_environment=development
TF_VAR_region=us-east-1
TF_VAR_vpc_cidr=10.0.0.0/16

# ECS/Container Settings
ECS_CLUSTER_NAME=dataaggregator-cluster
ECS_SERVICE_NAME=dataaggregator-service
CONTAINER_CPU=1024
CONTAINER_MEMORY=2048

# =============================================================================
# SECURITY NOTES
# =============================================================================

# IMPORTANT SECURITY REMINDERS:
#
# 1. NEVER commit .env to version control
# 2. Use strong, unique passwords for all services
# 3. Rotate JWT_SECRET_KEY regularly in production
# 4. Enable SSL/TLS for all database connections in production
# 5. Use environment-specific .env files (.env.development, .env.production)
# 6. Store production secrets in secure vaults (AWS Secrets Manager, HashiCorp Vault)
# 7. Enable HTTPS and set SESSION_COOKIE_SECURE=true in production
# 8. Restrict CORS_ALLOWED_ORIGINS to known domains in production
# 9. Use separate databases for development, staging, and production
# 10. Enable virus scanning (VIRUS_SCANNING_ENABLED=true) in production

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================

# Before deploying to production, ensure:
# [ ] DEBUG=false
# [ ] API_RELOAD=false
# [ ] Strong JWT_SECRET_KEY
# [ ] Production database credentials
# [ ] SSL/TLS enabled for all services
# [ ] CORS_ALLOWED_ORIGINS set to production domains only
# [ ] SESSION_COOKIE_SECURE=true
# [ ] SENTRY_DSN configured for error tracking
# [ ] Backup strategy configured
# [ ] All passwords rotated from development values
# [ ] Rate limiting enabled and tuned
# [ ] Monitoring and alerting configured
