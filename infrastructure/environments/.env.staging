# Staging Environment Configuration
# Data Aggregator Platform

# ==========================================================================
# Application
# ==========================================================================
ENVIRONMENT=staging
APP_VERSION=1.0.0-staging
APP_NAME=Data Aggregator Platform (Staging)
DEBUG=false

# ==========================================================================
# API Configuration
# ==========================================================================
API_HOST=0.0.0.0
API_PORT=8001
API_URL=https://staging-api.dataaggregator.com

# Frontend
FRONTEND_URL=https://staging.dataaggregator.com
NEXT_PUBLIC_API_URL=https://staging-api.dataaggregator.com

# ==========================================================================
# Database - PostgreSQL
# ==========================================================================
POSTGRES_HOST=postgres-staging.example.com
POSTGRES_PORT=5432
POSTGRES_DB=dataaggregator_staging
POSTGRES_USER=dataaggregator_staging
POSTGRES_PASSWORD=<CHANGE_ME_STAGING_DB_PASSWORD>

DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ==========================================================================
# Redis - Cache & Sessions
# ==========================================================================
REDIS_HOST=redis-staging.example.com
REDIS_PORT=6379
REDIS_PASSWORD=<CHANGE_ME_STAGING_REDIS_PASSWORD>
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

REDIS_POOL_SIZE=25
REDIS_POOL_TIMEOUT=10

# ==========================================================================
# Security
# ==========================================================================
JWT_SECRET_KEY=<CHANGE_ME_STAGING_JWT_SECRET>
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

SESSION_SECRET=<CHANGE_ME_STAGING_SESSION_SECRET>
SESSION_TIMEOUT_MINUTES=30

ALLOWED_ORIGINS=https://staging.dataaggregator.com,https://staging-api.dataaggregator.com

RATE_LIMIT_ENABLED=true
RATE_LIMIT_LOGIN=5
RATE_LIMIT_REGISTER=3
RATE_LIMIT_API=100
RATE_LIMIT_FILE_UPLOAD=10

# ==========================================================================
# File Storage
# ==========================================================================
UPLOAD_DIR=/var/data/dataaggregator-staging/uploads
MAX_FILE_SIZE_MB=100
ALLOWED_FILE_EXTENSIONS=.csv,.json,.xlsx,.xls,.txt,.xml,.parquet,.avro
SCAN_UPLOADED_FILES=true

# AWS S3
AWS_ACCESS_KEY_ID=<CHANGE_ME_STAGING_AWS_KEY>
AWS_SECRET_ACCESS_KEY=<CHANGE_ME_STAGING_AWS_SECRET>
AWS_REGION=us-east-1
S3_BUCKET=dataaggregator-staging-files
S3_ENDPOINT=https://s3.amazonaws.com

# ==========================================================================
# Monitoring & Observability
# ==========================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=<CHANGE_ME_STAGING_GRAFANA_PASSWORD>

SENTRY_DSN=https://<YOUR_STAGING_SENTRY_KEY>@sentry.io/<YOUR_STAGING_PROJECT_ID>
SENTRY_DEV_ENABLED=false
NEXT_PUBLIC_SENTRY_DSN=${SENTRY_DSN}

LOKI_URL=http://loki:3100

# ==========================================================================
# Alerting
# ==========================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=<CHANGE_ME_STAGING_SMTP_USERNAME>
SMTP_PASSWORD=<CHANGE_ME_STAGING_SMTP_PASSWORD>
SMTP_FROM=staging-alerts@dataaggregator.com

SLACK_WEBHOOK_URL=https://hooks.slack.com/services/<YOUR_STAGING_SLACK_WEBHOOK>

# ==========================================================================
# Logging
# ==========================================================================
LOG_LEVEL=DEBUG
LOG_FORMAT=json
LOG_FILE=/var/log/dataaggregator-staging/app.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=7

# ==========================================================================
# Performance
# ==========================================================================
WORKERS=2
WORKER_TIMEOUT=120
KEEP_ALIVE=5

CACHE_TTL=1800
CACHE_MAX_SIZE=500

# ==========================================================================
# Feature Flags
# ==========================================================================
ENABLE_WEBSOCKET=true
ENABLE_FILE_UPLOAD=true
ENABLE_PIPELINE_EXECUTION=true
ENABLE_REAL_TIME_MONITORING=true

# ==========================================================================
# Backup & Recovery
# ==========================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 3 * * *  # Daily at 3 AM
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=dataaggregator-staging-backups

# ==========================================================================
# CI/CD
# ==========================================================================
CI_CD_ENABLED=true
DEPLOY_METHOD=rolling
HEALTH_CHECK_TIMEOUT=60
READINESS_TIMEOUT=120

# ==========================================================================
# SSL/TLS
# ==========================================================================
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/staging.dataaggregator.crt
SSL_KEY_PATH=/etc/ssl/private/staging.dataaggregator.key

# ==========================================================================
# Docker Configuration
# ==========================================================================
COMPOSE_PROJECT_NAME=dataaggregator-staging
DOCKER_NETWORK=dataaggregator_staging_network

# ==========================================================================
# Kubernetes (if deploying to K8s)
# ==========================================================================
K8S_NAMESPACE=staging
K8S_CLUSTER=dataaggregator-staging
K8S_REPLICAS=2
K8S_RESOURCE_LIMITS_CPU=1
K8S_RESOURCE_LIMITS_MEMORY=2Gi
K8S_RESOURCE_REQUESTS_CPU=500m
K8S_RESOURCE_REQUESTS_MEMORY=1Gi

# ==========================================================================
# Database Migrations
# ==========================================================================
AUTO_MIGRATE=true  # Can auto-migrate in staging
MIGRATION_TIMEOUT=600

# ==========================================================================
# Security Headers
# ==========================================================================
ENABLE_HSTS=true
HSTS_MAX_AGE=31536000
ENABLE_CSP=true
ENABLE_CORS_CREDENTIALS=true

# ==========================================================================
# Testing
# ==========================================================================
ENABLE_TEST_DATA=true  # Allow test data in staging
TEST_USER_EMAIL=test@staging.dataaggregator.com
TEST_USER_PASSWORD=<CHANGE_ME_TEST_PASSWORD>
